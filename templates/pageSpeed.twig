{% extends '_layouts/cp' %}
{% includeCssResource "/auditr/css/style.css" %}
{% includeJsResource "/auditr/js/index.js" %}

{% set title = "Auditr" %}

{% set tabs = {
    info: { label: 'Info'|t, url: url('auditr') },
    templates: { label: 'Templates'|t, url: url('auditr/templates') },
    content: { label: 'Content'|t, url: url('auditr/content') },
    plugins: { label: 'Plugins'|t, url: url('auditr/plugins') },
    users: { label: 'Users'|t, url: url('auditr/users') },
    updates: { label: 'Updates'|t, url: url('auditr/updates') },
    pageSpeed: { label: 'Page Speed'|t, url: url('auditr/pageSpeed') },
    settings: {label: 'Settings'|t, url: url('auditr/settings')}
} %}

{% set selectedTab = 'pageSpeed' %}

{% set content %}

<a class="Export" href="{{ url('auditr/export') }}">Open Audit</a>
{% if craft.auditr.pdfExists %}
  <a class="Export" href="{{ url('auditr/download') }}">Download PDF</a>
  <a class="Export" href="{{ url('auditr/convert') }}">Regenerate PDF</a>
{% else %}
  <a class="Export" href="{{ url('auditr/convert') }}">Generate PDF</a>
{% endif %}

{% set settings = craft.auditr.getSettings %}
<div class="Section Section--pageSpeed">
  <h3 class="Section__header">Google PageSpeed Insights</h3>
  <div data-insights data-key="{{ settings.googleApiKey }}" data-url="{{ settings.siteUrl ?: siteUrl }}">
    {% if settings.googleApiKey %}
      <span data-spinner></span>
    {% else %}
      <a href="{{ url('auditr/settings') }}">
        Enter your Google API key to use this feature
      </a>
    {% endif %}
  </div>
</div>
{% endset %}
